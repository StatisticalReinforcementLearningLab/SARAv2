{"version":3,"file":"angularfire2.js","sourceRoot":"","sources":["../../../src/core/angularfire2.ts"],"names":[],"mappings":"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","sourcesContent":["import { InjectionToken, NgZone } from '@angular/core';\nimport { isPlatformServer } from '@angular/common';\nimport { Observable, Subscription, queueScheduler as queue } from 'rxjs';\n\n// Put in database.ts when we drop database-depreciated\nexport const RealtimeDatabaseURL = new InjectionToken<string>('angularfire2.realtimeDatabaseURL');\n\nexport class FirebaseZoneScheduler {\n  constructor(public zone: NgZone, private platformId: Object) {}\n  schedule(...args: any[]): Subscription {\n    return <Subscription>this.zone.runGuarded(function() { return queue.schedule.apply(queue, args)});\n  }\n  // TODO this is a hack, clean it up\n  keepUnstableUntilFirst<T>(obs$: Observable<T>) {\n    if (isPlatformServer(this.platformId)) {\n      return new Observable<T>(subscriber => {\n        const noop = () => {};\n        const task = Zone.current.scheduleMacroTask('firebaseZoneBlock', noop, {}, noop, noop);\n        obs$.subscribe(\n          next => {\n            if (task.state === 'scheduled') { task.invoke() };\n            subscriber.next(next);\n          },\n          error => {\n            if (task.state === 'scheduled') { task.invoke() }\n            subscriber.error(error);\n          },\n          () => {\n            if (task.state === 'scheduled') { task.invoke() }\n            subscriber.complete();\n          }\n        );\n      });\n    } else {\n      return obs$;\n    }\n  }\n  runOutsideAngular<T>(obs$: Observable<T>): Observable<T> {\n    return new Observable<T>(subscriber => {\n      return this.zone.runOutsideAngular(() => {\n        return obs$.subscribe(\n          value => this.zone.run(() => subscriber.next(value)),\n          error => this.zone.run(() => subscriber.error(error)),\n          ()    => this.zone.run(() => subscriber.complete()),\n        );\n      });\n    });\n  }\n}\n\nexport const runOutsideAngular = (zone: NgZone) => <T>(obs$: Observable<T>): Observable<T> => {\n  return new Observable<T>(subscriber => {\n    return zone.runOutsideAngular(() => {\n      runInZone(zone)(obs$).subscribe(subscriber);\n    });\n  });\n}\n\nexport const runInZone = (zone: NgZone) => <T>(obs$: Observable<T>): Observable<T> => {\n  return new Observable<T>(subscriber => {\n    return obs$.subscribe(\n      value => zone.run(() => subscriber.next(value)),\n      error => zone.run(() => subscriber.error(error)),\n      ()    => zone.run(() => subscriber.complete()),\n    );\n  });\n}\n"]}